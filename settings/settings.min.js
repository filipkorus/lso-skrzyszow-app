const usernameInput=document.querySelector("input[name=username]"),emailInput=document.querySelector("input[name=email]"),pw1Input=document.querySelector("input[name=pw1]"),pw2Input=document.querySelector("input[name=pw2]"),phoneNoInput=document.querySelector("input[name=phone_no]"),fileInput=document.querySelector("input[name=image]"),passwordInput=document.querySelector("input[name=password-confirm]");let action="";async function updateUsername(){const e=new FormData;e.append("username",usernameInput.value),e.append("password",passwordInput.value);const t=await fetch("./scripts/update-username.php",{method:"POST",body:e}),a=await t.json();UIkit.notification({message:a.msg,status:a.status||"danger",timeout:5e3}),passwordInput.value="","Nieprawidłowe hasło!"!==a.msg&&document.getElementById("open-modal").click(),a.error||(usernameInput.value="")}async function updateEmail(){const e=new FormData;e.append("email",emailInput.value),e.append("password",passwordInput.value);const t=await fetch("./scripts/update-email.php",{method:"POST",body:e}),a=await t.json();UIkit.notification({message:a.msg,status:a.status||"danger",timeout:5e3}),passwordInput.value="","Nieprawidłowe hasło!"!==a.msg&&document.getElementById("open-modal").click(),a.error||(emailInput.value="")}async function updatePassword(){const e=new FormData;e.append("new_password",pw1Input.value),e.append("password",passwordInput.value);const t=await fetch("./scripts/update-password.php",{method:"POST",body:e}),a=await t.json();UIkit.notification({message:a.msg,status:a.status||"danger",timeout:5e3}),passwordInput.value="","Nieprawidłowe hasło!"!==a.msg&&document.getElementById("open-modal").click(),a.error||(pw1Input.value="",pw2Input.value="")}async function updatePhoneNo(){const e=new FormData;e.append("phone_no",phoneNoInput.value),e.append("password",passwordInput.value);const t=await fetch("./scripts/update-phone-no.php",{method:"POST",body:e}),a=await t.json();UIkit.notification({message:a.msg,status:a.status||"danger",timeout:5e3}),passwordInput.value="","Nieprawidłowe hasło!"!==a.msg&&document.getElementById("open-modal").click(),a.error||(phoneNoInput.value="")}async function updateImage(){const e=new FormData;e.append("image",fileInput.files[0]),e.append("password",passwordInput.value);const t=await fetch("./scripts/update-picture.php",{method:"POST",body:e}),a=await t.json();UIkit.notification({message:a.msg,status:a.status||"danger",timeout:5e3}),passwordInput.value="","Nieprawidłowe hasło!"!==a.msg&&document.getElementById("open-modal").click(),a.error||(fileInput.value=null,document.querySelector("input[name=file-label]").value="Wybierz zdjęcie")}document.querySelector("form[name=username]").onsubmit=(e=>(e.preventDefault(),action="username",usernameInput.value.length?usernameInput.value.length<4||usernameInput.value.length>30?UIkit.notification({message:"Login powienien posiadać od 4 do 30 znaków!",status:"danger",timeout:5e3}):void document.getElementById("open-modal").click():UIkit.notification({message:"Uzupełnij wszystkie pola!",status:"danger",timeout:5e3}))),document.querySelector("form[name=email]").onsubmit=(e=>{if(e.preventDefault(),action="email",!emailInput.value.length)return UIkit.notification({message:"Uzupełnij wszystkie pola!",status:"danger",timeout:5e3});document.getElementById("open-modal").click()}),document.querySelector("form[name=password]").onsubmit=(e=>(e.preventDefault(),action="password",pw1Input.value.length&&pw1Input.value.length?pw1Input.value!==pw2Input.value?UIkit.notification({message:"Hasła nie są identyczne!",status:"danger",timeout:5e3}):pw1Input.value.length<6||pw1Input.value.length>30?UIkit.notification({message:"Hasło powinno posiadać od 6 do 30 znaków!",status:"danger",timeout:5e3}):void document.getElementById("open-modal").click():UIkit.notification({message:"Uzupełnij wszystkie pola!",status:"danger",timeout:5e3}))),document.querySelector("form[name=phone_no]").onsubmit=(e=>{if(e.preventDefault(),action="phone_no",!phoneNoInput.value.length)return UIkit.notification({message:"Uzupełnij wszystkie pola!",status:"danger",timeout:5e3});document.getElementById("open-modal").click()}),document.querySelector("form[name=image]").onsubmit=(e=>{if(e.preventDefault(),action="image",!fileInput.files.length)return UIkit.notification({message:"Dodaj zdjęcie!",status:"danger",timeout:5e3});document.getElementById("open-modal").click()}),document.getElementById("open-modal").onclick=(()=>{passwordInput.autofocus=!0}),document.querySelector("button[name=password-confirm]").onclick=(()=>{if(!passwordInput.value.length)return UIkit.notification({message:"Podaj hasło, aby zapisać zmiany!",status:"danger",timeout:5e3});switch(action){case"username":updateUsername();break;case"email":updateEmail();break;case"password":updatePassword();break;case"phone_no":updatePhoneNo();break;case"image":updateImage()}}),passwordInput.addEventListener("keyup",e=>{13===e.keyCode&&(e.preventDefault(),document.querySelector("button[name=password-confirm]").click())});